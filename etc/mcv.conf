#    Copyright 2015 Mirantis, Inc
#
#    Licensed under the Apache License, Version 2.0 (the "License"); you may
#    not use this file except in compliance with the License. You may obtain
#    a copy of the License at
#
#         http://www.apache.org/licenses/LICENSE-2.0
#
#    Unless required by applicable law or agreed to in writing, software
#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
#    License for the specific language governing permissions and limitations
#    under the License.

#
# MCVConsoler configuration file
#

#
# The 'basic' section is the common section for general options for
# MCVConsoler.
#
[basic]
#
# Option 'auth_protocol' determines whether your cloud supports SSL endpoints.
#
# Possible values:
#     * http  - for clouds without SSL endpoints
#     * https - for clouds with SSL endpoints
#
# By default, MCV assumes that cloud has SSL endpoints.
# In future releases, this option will be removed to be obtained automatically.
#
# NOTE: if not all of endpoints in your cloud are SSL-based, the behaviour of
# MCV is undefined.
#
auth_protocol=https
#
# Options for specifying place for logs of MCVConsoler.
logdir=/var/log
logfile=mcvconsoler.log
#
#
# Option 'mos_version' is required to run OSTF or BigData workload tests.
# It specifies the version of your MOS cloud.
#
# Possible values:
#
# +-------+---------+------+
# | Value | BigData | OSTF |
# +-------+---------+------+
# |  6.1  |    -    |  +   |
# |-------|---------|------|
# |  7.0  |    +    |  +   |
# |-------|---------|------|
# |  8.0  |    +    |  +   |
# +-------+---------+------+
#
# Hint: to obtain this value from your cloud, please log into Fuel Master Node
#       and run:
#
#       $ fuel --version
#
mos_version=7.0
#
#
#
# Option 'instance_ip' stands for IP of MCV host.
# Regarding to the way of running MCV, it equals one of next possible values:
#
# +-------------------------+-------------+
# |   Way to run            |    Value    |
# +-------------------------+-------------+
# | As an instance in cloud | floating IP |
# |-------------------------|-------------|
# | Host within L2 segment  | public IP   |
# |-------------------------|-------------|
# | Host within L3 segment  | public IP   |
# +-------------------------+-------------+
#
# Read more about network settings here:
#     * https://mirantis.jira.com/wiki/pages/viewpage.action?pageId=255133282
#
# WARNING: Be careful in setting up this option. If you run MCVConsoler with
#          incorrect instance_ip - it may cause issues:
#
#          * an invalid security group might be created in cloud (if you run
#            MCV as an instance)
#          * Shaker on MCV will be configured incorrectly, so you won't be
#            able to run Shaker tests until issues with Shaker container are
#            fixed
#
# NOTE: Default value of this option is not usable - please set correct value
#       by yourself!
#
instance_ip=127.0.0.1
#
#
#
# Section 'fuel' describes options required for access to Fuel Master Node.
# It's needed for next reasons:
#
#     * Running MCV in L3 segment, you'll need this to get access to the cloud
#     * For any way of running MCV if you want to run MCV OSTF suites

[fuel]
#
#
# Next options stand for credentials to access Fuel Master Node by SSH.
# By default, they're set to values usually used as default in any Mirantis
# OpenStack distributive.
#
username=admin
password=admin
#
# Option 'nailgun_host' stands for accessible IP of Fuel Master Node.
#
# If you run MCV in L3 segment, it must be its public IP. For L2 segment,
# you can use IP from admin network. In case of running MCV as an instance,
# you'll probably don't have access to Fuel Master Node.
#
# Besides running in L3 segment, this option is also used for extracting
# configuration for OSTF from Nailgun. If you don't have direct access to
# Fuel Master Node from MCV host (if you run MCV as an instance, for example),
# you'd need to generate it manually. Please read this article for details:
#   https://mirantis.jira.com/wiki/display/MCV/Extract+config+for+OSTF+manually
#
nailgun_host=10.20.0.2
cluster_id=1
ssh_cert=/root/.ssh/id_rsa
#

#
# Section 'auth' describes options used for direct access to cloud using
# credentials. This way is the only one in case you run MCV as an instance
# or in L2 segment. For L3 segment, you can omit this session.
[auth]
#
# Next options are equivalents of OS_USERNAME, OS_PASSWORD, OS_TENANT_NAME
# and OS_REGION_NAME
# in your cloud.
#
# Hint: you can get those values on any of your controller nodes at
# /root/openrc
# By default, these options are set to values default for Mirantis OpenStack.
os_username=admin
os_tenant_name=admin
os_password=admin
region_name=RegionOne
#
#
# Option 'auth_endpoint_ip' is a public endpoint of your cloud.
#
# Hint: you can find this value by running next command on your controller:
#     $ keystone endpoint-list
#
# If you've got publicURL with domain alias instead of IP (like
# 'public.fuel.local'), you can do on the same controller:
#     $ cat /etc/hosts | grep <alias>
#
# WARNING: Please set this option to correct value - don't use a default one!
auth_endpoint_ip=172.16.0.3
#
#
# Option 'auth_fqdn' is used if you have endpoints set using domain aliases.
# You can obtain this value by running command on controller:
#     $ cat /etc/hosts
#
# By default, this option is set to value default for Mirantis OpenStack.
#
auth_fqdn=public.fuel.local
#
#
# Next options are required if you run MCV as an instance. Please read
#     https://mirantis.jira.com/wiki/display/MCV/Limitations
# in section 'Common known issues' for details.
#
# Please make sure you set option "PasswordAuthentication yes" in
# /etc/ssh/sshd_config on this controller!
#
# WARNING: option 'controller_ip' is set to fake value - please set it
# manually!
controller_ip=172.16.0.4
#
# Option 'controller_uname' stands for username to log into specified
# controller by SSH. By default, it's set to value default for Mirantis
# OpenStack.
controller_uname=root
#
# Option 'controller_pwd' stands for password to log into specified
# controller by SSH. By default, it's set to value default for Mirantis
# OpenStack.
controller_pwd=r00tme
#
#
# Option 'ssh_key' provides a common place for SSH key to access cloud nodes.
# This option is required if you want to run tests for Network Speed between
# hardware nodes of your cloud.
#
# NOTE: By default, MCV stands to use private key from Fuel Master Node.
#       However, you can use any customly generated SSH key regarding to
#       possible security reasons or restrictions in your company.
#
# If you run MCV in L3 segment, this key is extracted automatically from Fuel
# Master Node and saved to this path. In other cases, you have to put this key
# manually by path specified.
#
ssh_key=/home/mcv/id_rsa
#

#
# Plugins configuration
#

#
# Configuration for Rally plugin
#
[rally]
#
# Please do not change this option unless you've implemented your own Rally
# plugin for MCV.
#
runner=RallyOnDockerRunner
# TODO(albartash): needs to be described
concurrency=5
vlan_amount=1
gre_enabled=False
#
# Next option limits how many tests are allowed to fail during test running
# of this plugin.
max_failed_tests=10
#

#
# Configuration for Rally Certification Task.
# You can either set these options to specific values, or left them default.
#
# These options can also be seen at
#     https://github.com/openstack/rally/blob/master/certification/openstack/task_arguments.yaml
#
[certification]
#
# List of services to be tested
services=authentication,neutron,cinder,glance,nova,keystone
#
# Amount of controllers to be used during testing
controllers_amount=1
#
# Amount of computes to be used during testing
computes_amount=2
#
# Amount of storages to be used during testing
storage_amount=1
#
# Amount of tenants to be used during testing
tenants_amount=1
#
# Amount of users to be used during testing
users_amount=1
#
# Amount of networks to be used during testing
network_amount=1
#

#
# Configuration for Rally Workload Tests.
# Includes configuration for SaaS Workload Tests and BigData Workload Tests.
#
[workload]
#
# Configuration for SaaS Workload Tests
#
# Amount of instances to be used during testing
instance_count=2
#
# TODO(albartash): needs to be described
concurrency=1
#
#
# Configuration for BigData Workload Tests.
#
# TODO(albartash): needs to be described
# Specified in Kb, recommended value is 10000000
file_size=10000
#
# Amount of workers
workers_count=3
#
#
# Test flavor configuration
#
# Amount of RAM
ram=8096
#
# Size of HDD
disc=20
#
# Amount of CPUs to be used
vcpu=4
#

#
# Configuration for Tempest plugin.
# Tempest tests will be run using Rally.
#
[tempest]
#
# Please do not change this option unless you've implemented your own Tempest
# plugin for MCV.
#
runner=TempestOnDockerRunner
#
# Next option limits how many tests are allowed to fail during test running
# of this plugin.
max_failed_tests=100
#

#
# Configuration for OSTF plugin.
# OSTF plugin runs OSTF tests from within MCV, not from Fuel Master Node.
#
[ostf]
#
# Please do not change this option unless you've implemented your own OSTF
# plugin for MCV.
#
runner=OSTFOnDockerRunner
#
# Next option limits how many tests are allowed to fail during test running
# of this plugin.
max_failed_tests=10
#

#
# Configuration for Resource plugin.
# Resource plugin will check resources of cloud.
#
[resources]
#
# Please do not change this option unless you've implemented your own
# Resource plugin for MCV.
#
runner=ResourceReportRunner
#
# Next option limits how many tests are allowed to fail during test running
# of this plugin.
max_failed_tests=1
#

#
# Configuration for Shaker plugin.
# Shaker plugin uses Shaker tool for measuring network speed between VMs.
#
[shaker]
#
# Please do not change this option unless you've implemented your own Shaker
# plugin for MCV.
#
runner=ShakerOnDockerRunner
#
# TODO(albartash): what's it about?
shaker_image=-1
#
# Determines whether to do cleanup after Shaker running or not.
# Usually, setting cleanup=False is used only for debugging, so you can left
# it as-is.
cleanup=True
#
# Timeout for waiting until Shaker scenario is finished.
# If scenario has not been completed before timeout event happened, the task
# will be interrupted.
# Value of this option is set in seconds.
timeout=1200
#
# Next option limits how many tests are allowed to fail during test running
# of this plugin.
max_failed_tests=1
#
# TODO(albartash): should we uncomment it?
#image_name=shaker-image
#
# Name of flavor to be used for Shaker tests
flavor_name=shaker-flavor
#
# Network name to be used by Shaker for tests.
# By default, if this value is not presented, Shaker will pick up the first
# available network from the cloud automatically. It's recommended to leave
# this option commented iff your cloud does not have a very complicated
# networking.
#
# The default value presented for this option here is the name of such network
# for MOS 7.0.
#network_ext_name=net04_ext
#

#
# Configuration for Network Speed Tests.
# These tests are provided as Shaker scenarios and also by using
# NWSpeed plugin (for measuring speed between hardware nodes).
#
[network_speed]
#
# Threshold of network speed specified in Gb/s.
# If no value specified, MCV will take the default value from its config
#
threshold=7
#
# Name of private network in cloud.
# The default value for this option is a name of such network in default MOS
# 7.0 configuration.
network_name=net04
#

#
# Configuration for Speed plugin.
#
[speed]
#
# Please do not change this option unless you've implemented your own
# Speed plugin for MCV.
runner=SpeedTestRunner
#
# Path to cirros image on MCV host used for measuring speed.
# You should leave it as-is unless you want to run MCV using a custom image.
#cirros_image_path=/home/mcv/toolbox/rally/images/cirros-0.3.1-x86_64-disk.img
#
# Flavor requirements.
# TODO(albartash): improve comments
# Supported params: ram, vcpus, disk
#flavor_req=ram:64,vcpus:1
#
# Test image/volume size specified in Gb (G) or Mb (M).
# If options are commented, a default value will be picked up.
#image_size=1G
#
#volume_size=1G
#
# Threshold of storage speed specified in Mb/s
#threshold=50
#
# Next option limits how many tests are allowed to fail during test running
# of this plugin.
max_failed_tests=10
#
# Limit of compute nodes quantity to be used for measuring speed.
# If this option is not defined, speed will be measured on all compute nodes.
#compute_nodes_limit=2
#
# Limit attempts for each write(upload)/read(download) iteration.
# If this option is not defined, a default value will be used
attempts=3
#

#
# Configuration for NWSpeed plugin.
# This plugin provides functionality of measuring speed between hardware nodes.
#
[nwspeed]
#
# Please do not change this option unless you've implemented your own NWSpeed
# plugin for MCV.
#
runner=NWSpeedTestRunner
#
# Speed threshold specified in Mb\s.
# If this option is not defined, a default value will be used.
threshold=100
#
# Option 'range' describes possible range of speed deviation of the average
# value. Specified in percents.
# If this value is not set, a default value will be used.
range=10
#
# Port in admin network for testing network speed.
# Testing will be done using utility 'nc', and this option provides a port
# number for it.
# By default, NWSpeed plugin tries to access nodes through the default VNC
# port. If this port is not available, you have to specify an open one.
#
# NOTE: This port must be similar on every node.
#
test_port=5903
#
# Data size for testing. Specified in Mb.
# If this option is not set, a default value will be used.
data_size=100
#

#
# Configuration for SelfCheck plugin.
# This plugin is used when you need to check your MCV image to be valid and
# ready to be used. It is used on CI stage, so you don't need to run MCV
# self-check commands by yourself if you've got a stable image.
#
[selfcheck]
#
# Please do not change this option unless you've implemented your own SelfCheck
# plugin for MCV.
#
runner=SelfCheckRunner
#

#
# Configuration for Test Duration Database.
# MCV provides functionality to store results of test running, so it can be
# saved somewhere or used as ETA for the next run.
#
[times]
#
# Option 'update' checks whether to save results of the last run.
# Possible values:
#
#     * True  - enable results
#     * False - disable saving results
#
# By default, this option is set to True.
# You can get this file on your MCV host at /etc/mcv/times.json.
update = True
#


#
# Configuration for MCV Test Groups.
#
# MCV allows to run tests in three ways:
#
# +----------------------------+--------------------------------------------+
# |      Way to run tests      |               Shell command                |
# +----------------------------+--------------------------------------------+
# |   Run a full test suite    | $ mcvconsoler --run full                   |
# |   Run a custom test group  | $ mcvconsoler --run group <group>         |
# |   Run a single test        | $ mcvconsoler --run single <plugin> <test> |
# +----------------------------+--------------------------------------------+
#
# In most of cases you don't need to use running of single test.
# In case you want to run all tests, please run a full test suite.
# In case you want to run some specific tests, please use custom test groups.
#
# You can use the preset test groups, or create your own one.
#
# Each custom test group has the next syntax:
#
# [custom_test_group_<groupname>]
# plugin1=test1,test2,test3
# plugin2=test01,test02,
#         test03
#
#
# Example:
#
# [custom_test_group_example]
# resources=GeneralResourceSearch,ErrorResourceSearch
# tempest=telemetry
# rally=load-keystone-create-and-delete-user.yaml
#
#
# MCV provides predefined test groups organized by aim of running tests within
# them. You can also see the list of these groups in our documentation:
#
#     https://mirantis.jira.com/wiki/display/MCV/List+of+basic+test+groups
#
# NOTE: Some of tests in predefined test groups are disabled from the start.
# You can uncomment them if your cloud satisfy requirements related to such
# tests.
#

[custom_test_group_quick]
#
# NOTE: OSTF test support is incomplete. It is going to be fixed in future
# releases.
#

resources=ErrorResourceSearch,GeneralResourceSearch
ostf=SanityIdentityTest,SanityComputeTest,GlanceSanityTests,
  SanityHeatTest,NetworksTest,GlanceSmokeTests,
  FlavorsAdminTest,VolumesTest,TestImageAction,
  HeatSmokeTests:test_actions,
  HeatSmokeTests:test_advanced_actions,
  HeatSmokeTests:test_update,
  HeatSmokeTests:test_rollback,
# HeatSmokeTests:test_autoscaling,
# HeatSmokeTests
#
# Uncomment if you have Murano installed
#  ,MuranoSanityTests
#
# Uncomment if you have Sahara installed
#  ,VanillaTwoTemplatesTest,HDPTwoTemplatesTest
#
# Uncomment if you have Ceilometer installed
#  ,CeilometerApiTests
#

[custom_test_group_selfcheck]
selfcheck=BasicSelfCheck

[custom_test_group_functional]
tempest=baremetal,compute,database,data_processing,
        identity,image,messaging,network,object_storage,
        orchestration,scenario,smoke,telemetry,volume

[custom_test_group_smoke]
rally=certification

[custom_test_group_speed]
speed=ObjectStorageSpeed,BlockStorageSpeed
shaker=same_node.yaml, different_nodes.yaml, floating_ip.yaml,
       different_nodes_threads_10.yaml, full_l3_east_west.yaml
nwspeed=Node2NodeSpeed

[custom_test_group_workload]
rally=workload.yaml,big-data-workload.yaml

[custom_test_group_scale]
rally=load-ceilometer-create-alarm.yaml,
      load-ceilometer-create-and-delete-alarm.yaml,
      load-ceilometer-create-and-list-alarm.yaml,
      load-ceilometer-create-and-query-alarm-history.yaml,
      load-ceilometer-create-and-query-alarms.yaml,
      load-ceilometer-create-and-query-samples.yaml,
      load-ceilometer-create-and-update-alarm.yaml,
      load-ceilometer-create-meter-and-get-stats.yaml,
      load-ceilometer-list-alarms.yaml,
      load-ceilometer-list-meters.yaml,
      load-ceilometer-list-resources.yaml,
      load-cinder-create-and-attach-volume.yaml,
      load-cinder-create-and-delete-snapshot.yaml,
      load-cinder-create-and-delete-volume.yaml,
      load-cinder-create-and-extend-volume.yaml,
      load-cinder-create-and-list-snapshots.yaml,
      load-cinder-create-and-list-volume.yaml,
      load-cinder-create-and-upload-volume-to-image.yaml,
      load-cinder-create-from-volume-and-delete-volume.yaml,
      load-cinder-create-snapshot-and-attach-volume.yaml,
      load-glance-create-and-delete-image.yaml,
      load-glance-create-and-list-image.yaml,
      load-glance-create-image-and-boot-instances.yaml,
      load-glance-list_images.yaml,
      load-heat-create-and-delete-stack_with_neutron.yaml,
      load-heat-create-and-delete-stack_with_volume.yaml,
      load-heat-create-and-delete-stack.yaml,
      load-heat-create-and-list-stack.yaml,
      load-heat-create-check-delete-stack.yaml,
      load-heat-create-suspend-resume-delete-stack.yaml,
      load-heat-create-update-delete-stack-add-res.yaml,
      load-heat-create-update-delete-stack-del-res.yaml,
      load-heat-create-update-delete-stack-increase.yaml,
      load-heat-create-update-delete-stack-inplace.yaml,
      load-heat-create-update-delete-stack-reduce.yaml,
      load-heat-create-update-delete-stack-replace.yaml,
      load-heat-list-stack-and-resources.yaml,
      load-keystone-create-and-delete-user.yaml,
      load-keystone-create-and-list-tenants.yaml,
      load-keystone-create-and-list-users.yaml,
      load-keystone-create-tenant-with-users.yaml,
      load-neutron-create_and_delete_networks.yaml,
      load-neutron-create_and_delete_ports.yaml,
      load-neutron-create_and_delete_routers.yaml,
      load-neutron-create_and_delete_subnets.yaml,
      load-neutron-create_and_list_networks.yaml,
      load-neutron-create_and_list_ports.yaml,
      load-neutron-create_and_list_routers.yaml,
      load-neutron-create_and_list_subnets.yaml,
      load-neutron-create_and_update_networks.yaml,
      load-neutron-create_and_update_ports.yaml,
      load-neutron-create_and_update_routers.yaml,
      load-neutron-create_and_update_subnets.yaml,
      load-neutron-update_quotas.yaml,
      load-nova-boot_and_bounce_server.yaml,
      load-nova-boot_and_delete_server_with_keypair.yaml,
      load-nova-boot_and_delete_server_with_secgroups.yaml,
      load-nova-boot_and_delete_server.yaml,
      load-nova-boot_and_list_server_batch_all_at_once.yaml,
      load-nova-boot_and_list_server_batch_x10.yaml,
      load-nova-boot_and_list_server.yaml,
      load-nova-boot_and_migrate_server.yaml,
      load-nova-boot_and_rebuild_server.yaml,
      load-nova-boot_server_from_volume_and_delete.yaml,
      load-nova-boot_server_from_volume_and_live_migrate.yaml,
      load-nova-create_and_delete_keypair.yaml,
      load-nova-create_and_delete_secgroups.yaml,
      load-nova-create_and_list_keypairs.yaml,
      load-nova-create_and_list_secgroups.yaml,
      load-nova-nova-update-and-delete.yaml,
      load-nova-pause_and_unpause.yaml,
      load-nova-resize_server.yaml,
      load-nova-snapshot_server.yaml,
      load-nova-suspend_and_resume.yaml,
      load-swift-create-container-and-object-then-delete-all.yaml,
      load-swift-create-container-and-object-then-download-object.yaml,
      load-swift-create-container-and-object-then-list-objects.yaml,
      load-swift-list-and-download-objects-in-containers.yaml,
      load-swift-list-objects-in-containers.yaml
